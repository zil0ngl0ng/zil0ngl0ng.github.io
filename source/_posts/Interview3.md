---
title: 面经复盘 —— 腾讯魔方工作室一面
date: 2024-3-11 15:46:06
categories:
- 面经
mathjax: true
---
腾讯魔方工作室一面面经。
<!-- more -->
### 1. 你了解C++里面什么是虚函数吗？虚函数有什么用途
### 2. 构造函数可以设置成虚函数吗？
被virtual关键字修饰的成员函数，就是虚函数。虚函数的作用，用专业术语来解释就是实现多态性（Polymorphism），多态性是将接口与实现进行分离；用形象的语言来解释就是实现以共同的方法，但因个体差异，而采用不同的策略。
【构造函数为什么不能为虚函数？析构函数为什么要虚函数？】
（1）从存储空间角度，虚函数相应一个指向vtable虚函数表的指针，这大家都知道，但是这个指向vtable的指针事实上是存储在对象的内存空间的。问题出来了，假设构造函数是虚的，就须要通过 vtable来调用，但是对象还没有实例化，也就是内存空间还没有，怎么找vtable呢？所以构造函数不能是虚函数。
（2）从使用角度，虚函数主要用于在信息不全的情况下，能使重载的函数得到相应的调用。构造函数本身就是要初始化实例，那使用虚函数也没有实际意义呀。所以构造函数没有必要是虚函数。虚函数的作用在于通过父类的指针或者引用来调用它的时候可以变成调用子类的那个成员函数。而构造函数是在创建对象时自己主动调用的，不可能通过父类的指针或者引用去调用，因此也就规定构造函数不能是虚函数。
（3）从实现上看，vbtl在构造函数调用后才建立，因而构造函数不可能成为虚函数从实际含义上看，在调用构造函数时还不能确定对象的真实类型（由于子类会调父类的构造函数）；并且构造函数的作用是提供初始化，在对象生命期仅仅运行一次，不是对象的动态行为，也没有必要成为虚函数。
C++中基类采用virtual虚析构函数是为了防止内存泄漏。
具体地说，如果派生类中申请了内存空间，并在其析构函数中对这些内存空间进行释放。假设基类中采用的是非虚析构函数，当删除基类指针指向的派生类对象时就不会触发动态绑定，因而只会调用基类的析构函数，而不会调用派生类的析构函数。那么在这种情况下，派生类中申请的空间就得不到释放从而产生内存泄漏。

### 3. 在C++里面内存分为堆内存和栈内存，你了解这两块内存吗？
### 4. 栈内存为什么效率比堆内存高？
首先,栈是由CPU提供指令支持的, 在指令的处理速度上, 对栈数据进行处理的速度自然要优于由操作系统支持的堆数据. 
其次,栈在一级缓存中做缓存的, 而堆则是在二级缓存中, 两者在硬件性能上差异巨大. 
再者,栈是本着LIFO原则的存储机制, 对栈数据的定位相对比较快速, 而堆则是随机分配的空间, 处理的数据比较多, 无论如何, 至少要两次定位. 还有内存碎片，查找浪费时间的原因。

### 5. 新版C++里面引入了智能指针，解释一下是怎么实现的以及有什么作用？
实现：智能指针类将一个计数器与类指向的对象相关联，引用计数跟踪该类有多少个对象共享同一指针。每次创建类的新对象时，初始化指针并将引用计数置为1；当对象作为另一对象的副本而创建时，拷贝构造函数拷贝指针并增加与之相应的引用计数；对一个对象进行赋值时，赋值操作符减少左操作数所指对象的引用计数（如果引用计数减至0，则删除对象），并增加右操作数所指对象的引用计数；调用析构函数时，构造函数减少引用计数（如果引用计数减至0，则删除基础对象）。`智能指针就是模拟指针动作的类`。所有的智能指针都会重载 -> 和 * 操作符。智能指针还有许多其他功能，比较有用的是自动销毁。这主要是利用栈对象的有限作用域以及临时对象（有限作用域实现）析构函数释放内存。

### 6. 你用的版本是什么？后续新版本C++了解过吗？
### 7. C++11引入右值引用概念，是什么用？
1、	左值
（1）左值是一个数据的表达式(如变量名或引用的指针)，我们可以获取到它的地址，正常情况下是可以能够对它赋值，定义const修饰后的左值，不能给它赋值，但是可以取出它的地址。
（2）左值可以出现在赋值符号( " = ")的左边，也可以出现在赋值符号(" = “ )的右边。
（3）左值具有持久的状态。
2、	右值
（1）右值也是一个数据表达式，右值是字面常量或者是求值过程种创建的临时对象，右值的生命周期是短暂的，如：字面常量，表达式返回值，函数返回值（不是左值引用的返回值），临时变量，匿名对象等等，
（2）右值不能出现在赋值符号的左边，右值也不能取出地址，更不能对它赋值。
3、	左值引用
（1）左值引用是对左值的一种引用，相当于给左值取别名。
（2）普通的左值引用不能引用右值，但是const的左值引用可以引用右值。
（3）引用方法: 类型+&，例如： int& pa=a；pa引用a变量。
左值引用作为函数的参数，能够减少拷贝。
一个函数的返回值出了该函数作用域后就会被销毁掉，这个返回值的生命周期就结束了，因此就不能使用传引用返回，所以只能通过传值返回，而传值返回至少需要进行一次拷贝构造
4、	右值引用 &&
（1）右值引用是给右值取别名，所有的右值引用是不能引用左值。
（2）右值是不能取出地址的，但是当右值取别名后，这个右值会被存到特定的位置，且可以取到该值的地址，也就是说右值引用值是一个左值。
（3）右值引用会开辟一块空间去存右值，其中普通的右值引用是可以修改这块空间的，const的右值引用时不可以被修改的。
（4）标准库中的move函数可以将一个左值强制转换为右值
因为在执行构造函数的时候，编译器会去判断等号右边的返回的是否是临时对象，如果是临时对象就会调用移动构造函数，不是临时对象就会调用拷贝构造函数。
5、	引入右值引用的原因
（1）替代需要销毁对象的拷贝，提高效率：某些情况下，需要拷贝一个对象然后将其销毁，如：临时类对象的拷贝就要先将旧内存的资源拷贝到新内存，然后释放旧内存，引入右值引用后，就可以让新对象直接使用旧内存并且销毁原对象，这样就减少了内存和运算资源的使用，从而提高了运行效率；
（2）移动含有不能共享资源的类对象：像IO、unique_ptr这样的类包含不能被共享的资源（如：IO缓冲、指针），因此，这些类对象不能拷贝但可以移动。这种情况，需要先调用std::move将左值强制转换为右值，再进行右值引用。

### 8. C++11和之前的相比，比较有特色的功能是什么？
### 9. 明确定义int和用auto性能上有差别吗？
### 10. C++里面的动态数组vector和python里的list实现有什么区别？
### 11. TCP和UDP的区别？
### 12. TCP是可靠的，UDP是不可靠的，那么可靠和不可靠体现在哪里呢？
### 13. TCP，如果网络不太好，发送方收到了后面序号的包，接收方会怎么处理呢？
接收方使用接收缓冲区来存储到达的乱序数据包。TCP协议会根据数据包的序列号将其放入适当的位置，而不是丢弃乱序数据包。

### 14. TCP断开连接的过程
### 15. TCP断开会有TimeWait状态，它有什么作用？
### 16. 长连接和短连接的应用场景
**长连接**:是指在一个TCP连接上可以发送多个数据包,但是如果没有数据包发送时,也要双方发检测包以维持这个链连接
**短连接**:当双方需要有数据交互的时候,就建立一个TCP连接,本次交互完成后,就断开这个连接
长连接可以省去较多建立和关闭连接的操作,所以比较节省资源和时间,但是长连接如果一直存在的话,第一需要很多探测包的发送来维持这个连接,第二对服务器将是很大的负荷
短连接则不需要服务器承担太大负荷,只要存在的连接就都是有用连接,但如果客户端请求频繁,就会在TCP的建立连接和关闭连接上浪费较大的资源和时间
像京东,淘宝这些大型的网站,随时随刻有成千上万的用户对服务端发送请求,一般使用短连接,因为如果用长连接的话,用户越来越多,服务器一般扛不住这么多长连接
而即时通讯(比如QQ)一般使用的是长连接(UDP长连接),但并不是永久连接,一般也会有一个保持的时间,比如30分钟,24小时等,因为即时通讯是频繁的发送请求,使用长连接只需要建立一次连接,比较划算,同时再根据业务设置保持时间,超过这个时间就断开连接,也一定程度上保证了服务器的压力不会过大。同理,网络游戏一般也使用长连接,同理即时通讯

### 17. 了解过进程、线程和协程的概念吗？
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/images/I3_f1.png" width = "80%" alt=""/>
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
      <!-- figure 1: 套接字通信的文件描述符 -->
  	</div>
</center> 

### 18. 进程里有个概念是死锁，能说一下什么是死锁吗？
### 19. 进程之间的通信方式有哪些？
### 20. 什么情况下用共享内存，什么时候用消息队列？
### 21. 数据库，我看你们用的是mysql数据库，有了解其他数据库吗？
### 22. MySQL和Redis的区别
（1）类型上
     从类型上来说，mysql是关系型数据库，redis是缓存数据库
（2）作用上
     mysql用于持久化的存储数据到硬盘，功能强大，但是速度较慢
     redis用于存储使用较为频繁的数据到缓存中，读取速度快
（3）需求上
     mysql和redis因为需求的不同，一般都是配合使用。
### 23. 选型的时候从哪些方面考虑？
### 24. MySQL有考虑过某一段时间数据出错回档考虑过怎么做吗？
### 25. 八个台球，有一个重的，其他七个一样重，有一个天平不称出具体重量，最少需要几次？
2次。
第一次分为3，3，2，将两组3放在天平上；
如果重量相同，那么把剩下的两个放在天平上比较；
如果不同，把重的一组三个其中两个放在天平上，如果一样重则第三个最重，否则就是两个中的一个最重。
### 26. 算法题：滑动窗口的最大值
### 27. 你对UE4的了解只是基于那个项目是吧
### 28. 个人对于游戏开发有兴趣吗？
### 29. 你主要喜欢哪种类型的游戏
### 30. 对fps游戏接触过吗？







